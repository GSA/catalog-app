version: 2
jobs:
  build:
    machine: true
    steps:
      - checkout
      - run:
          name: Run tests
          command: make test

  deploy_cloud_gov:
    machine: true
    steps:
      - curl -v -L -o cf-cli_amd64.deb 'https://cli.run.pivotal.io/stable?release=debian64&source=github'
      - sudo dpkg -i cf-cli_amd64.deb
      - cf -v

workflows:
  main:
    jobs:
      - build
      - deploy_cloud_gov
